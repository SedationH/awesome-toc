{"mappings":"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","sources":["src/Tree.tsx","src/debug.ts","src/HasChildrenIcon.tsx","src/style.module.less"],"sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport classnames from \"classnames\"\nimport { log } from \"./debug\"\nimport HasChildrenIcon from \"./HasChildrenIcon\"\nimport * as style from \"./style.module.less\"\n\ntype TreeData = NodeData[]\n\nfunction deleteKeyFromArray(key: string, array: string[]) {\n  return array.filter((keyFromArray) => keyFromArray !== key)\n}\n\ninterface TreeProps {\n  data: TreeData\n  selectedKeys?: string[]\n  expandedKeys?: string[]\n  defaultExpandedKeys?: string[]\n  defaultSelectedKeys?: string[]\n  onSelect?: (keys: string[], { node: NodeData }) => void\n  onExpand?: (keys: string[], { node: NodeData }) => void\n}\n\nfunction Tree({\n  data = [],\n  selectedKeys: selectedKeysFromProps,\n  expandedKeys: expandedKeysFromProps,\n  defaultExpandedKeys = [],\n  defaultSelectedKeys = [],\n  onSelect,\n  onExpand,\n}: TreeProps) {\n  const [selectedKeys, setSelectedKeys] = useState(\n    selectedKeysFromProps || defaultSelectedKeys\n  )\n  const [expandedKeys, setExpandedKeys] = useState(\n    expandedKeysFromProps || defaultExpandedKeys\n  )\n\n  useEffect(() => {\n    // 处理 selectedKeysFromProps 的 变化\n    // 也要防止第一次变为 undefined\n    selectedKeysFromProps && setSelectedKeys(selectedKeysFromProps)\n    log(\"selectedKeysFromProps useEffect\", {\n      expandedKeysFromProps,\n      selectedKeys,\n    })\n  }, [selectedKeysFromProps])\n\n  useEffect(() => {\n    // 处理 expandedKeysFromProps 的 变化\n    // 也要防止第一次变为 undefined\n    expandedKeysFromProps && setExpandedKeys(expandedKeysFromProps)\n    log(\"expandedKeysFromProps useEffect\", {\n      expandedKeysFromProps,\n      expandedKeys,\n    })\n  }, [expandedKeysFromProps])\n\n  const onTreeSelect: (\n    key: string,\n    { selected: bool, node: NodeData }\n  ) => void = (key, { selected, node }) => {\n    const keys = selected\n      ? selectedKeys.concat(key)\n      : deleteKeyFromArray(key, selectedKeys)\n    onSelect?.(keys, { node })\n\n    log(\"onTreeSelect\", keys)\n\n    // 如果外界没有传入 selectedKeysFromProps 状态需要自己维护\n    if (!selectedKeysFromProps) {\n      setSelectedKeys(keys)\n    }\n  }\n\n  const onTreeExpand: (\n    key: string,\n    { expanded: bool, node: NodeData }\n  ) => void = (key, { expanded, node }) => {\n    const keys = expanded\n      ? expandedKeys.concat(key)\n      : deleteKeyFromArray(key, expandedKeys)\n    onExpand?.(keys, { node })\n\n    log(\"onTreeExpand\", keys)\n\n    // 如果外界没有传入 expandedKeysFromProps 状态需要自己维护\n    if (!expandedKeysFromProps) {\n      setExpandedKeys(keys)\n    }\n  }\n\n  log(\"Tree render\", { selectedKeys, expandedKeys })\n\n  return (\n    <div className={style.tree}>\n      {data.map((nodeData) => (\n        <TreeNode\n          key={nodeData.key}\n          data={nodeData}\n          selectedKeys={selectedKeys}\n          expandedKeys={expandedKeys}\n          onSelect={onTreeSelect}\n          onExpand={onTreeExpand}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport interface NodeData {\n  key: string\n  title: string\n  children?: NodeData[]\n}\n\ninterface TreeNodeProps {\n  data: NodeData\n  selectedKeys: string[]\n  expandedKeys: string[]\n  onSelect: (key: string, { selected: bool, node: NodeData }) => void\n  onExpand: (key: string, { expanded: bool, node: NodeData }) => void\n}\n\nfunction TreeNode({\n  data,\n  selectedKeys,\n  expandedKeys,\n  onSelect,\n  onExpand,\n}: TreeNodeProps) {\n  const hasChildren = data.children?.length ? true : false\n  const selected = selectedKeys?.includes(data.key)\n  const expanded = expandedKeys?.includes(data.key)\n\n  const onNodeSelect = () => {\n    log(\"onNodeSelect\", { selected: !expanded, data, key: data.key })\n    onSelect(data.key, {\n      selected: !selected,\n      node: data,\n    })\n  }\n\n  const onNodeExpand = () => {\n    log(\"onNodeExpand\", { expanded: !expanded, data, key: data.key })\n    onExpand(data.key, {\n      expanded: !expanded,\n      node: data,\n    })\n  }\n\n  return (\n    <div className={style[\"tree-node\"]}>\n      <div className={style[\"content\"]}>\n        {hasChildren ? (\n          <div onClick={onNodeExpand} className={style[\"switcher\"]}>\n            <HasChildrenIcon\n              className={classnames(style[\"switcher-icon\"], {\n                [style[\"expanded\"]]: expanded,\n              })}\n            />\n          </div>\n        ) : (\n          <div className={style[\"switcher-placeholder\"]}></div>\n        )}\n        <div\n          className={classnames(style[\"title-wrapper\"], {\n            [style[\"selected\"]]: selected,\n          })}\n          onClick={onNodeSelect}\n        >\n          <span>{data.title}</span>\n        </div>\n      </div>\n      <div\n        className={classnames(style[\"children-wrapper\"], {\n          [style[\"expanded\"]]: expanded,\n        })}\n      >\n        {data.children.map((nodeData) => (\n          <TreeNode\n            data={nodeData}\n            key={nodeData.key}\n            selectedKeys={selectedKeys}\n            expandedKeys={expandedKeys}\n            onSelect={onSelect}\n            onExpand={onExpand}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default Tree\nexport { TreeData }\n","const isDebugging = false\n\nconst log = (...args) => {\n  if (!isDebugging) return\n  console.log(...args)\n}\n\nexport { log }\n","import React from \"react\"\n\nfunction HasChildrenIcon({ style = {}, className = \"\" }) {\n  return (\n    <svg\n      style={{\n        width: \"14px\",\n        height: \"14px\",\n        ...style,\n      }}\n      className={className}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 1024 1024\"\n    >\n      <path d=\"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z\" />\n    </svg>\n  )\n}\n\nexport default HasChildrenIcon\n",".tree {\n  .tree-node {\n    padding-left: 1em;\n\n    .content {\n      line-height: 24px;\n      display: flex;\n      align-items: stretch;\n      padding-bottom: 2px;\n\n      .switcher {\n        cursor: pointer;\n        user-select: none;\n\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 24px;\n\n        .switcher-icon {\n          transition-property: transform;\n          transition-duration: 0.3s;\n          transform: rotate(-90deg);\n\n          &.expanded {\n            transform: rotate(0deg);\n          }\n        }\n      }\n\n      .switcher-placeholder {\n        width: 24px;\n      }\n\n      .title-wrapper {\n        padding: 0 4px;\n        border-radius: 2px;\n        cursor: pointer;\n\n        transition-property: background-color;\n        transition-duration: 0.3s;\n\n        &:hover {\n          background-color: #f5f5f5;\n        }\n\n        &.selected {\n          background-color: #bae7ff;\n        }\n      }\n    }\n\n    .children-wrapper {\n      transition: max-height, 0.3s;\n      max-height: 0;\n      overflow: auto;\n\n      &.expanded {\n        display: block;\n        max-height: 200px;\n      }\n    }\n  }\n}\n"],"names":[],"version":3,"file":"module.js.map"}